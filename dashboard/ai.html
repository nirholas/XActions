<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Tweet Writer - XActions | Voice Analysis & AI-Powered Content Generation</title>
  <meta name="description" content="AI-powered tweet writer that scrapes your tweet history, analyzes your voice, and generates new tweets in your style. Integrated with Twitter scraping. No API fees.">
  <meta name="keywords" content="AI Twitter automation, LLM Twitter bot, GPT Twitter integration, Claude Twitter automation, MCP server Twitter, AI agents for X, machine learning Twitter, AI-powered Twitter bot, ChatGPT Twitter, Claude Desktop Twitter, Cursor AI Twitter, VS Code Copilot Twitter, Twitter AI agent, LLM social media automation, AI content moderation Twitter, smart follower management AI, automated engagement AI, AI scheduling Twitter, Model Context Protocol Twitter, programmatic Twitter API, AI Twitter tools, intelligent Twitter automation, GPT-4 Twitter bot, Claude 3 Twitter, Twitter ML automation, neural network Twitter, deep learning Twitter bot, NLP Twitter automation, AI social media manager, autonomous Twitter agent, AI Twitter assistant, LLM API Twitter, OpenAI Twitter integration, Anthropic Claude Twitter, Twitter automation framework, AI-driven social media, smart Twitter bot, cognitive Twitter automation, AI engagement bot, Twitter AI SDK, LLM powered automation">
  <meta name="author" content="nich (@nichxbt)">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="AI Integration - XActions | GPT, Claude & LLM Twitter Automation">
  <meta property="og:description" content="Connect AI agents to X/Twitter with MCP server support. Works with ChatGPT, Claude, Cursor, VS Code Copilot and custom LLMs. Build intelligent automation.">
  <meta property="og:url" content="https://xactions.app/ai">
  <meta property="og:site_name" content="XActions">
  <meta property="og:image" content="https://xactions.app/og-ai.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="XActions AI Integration - Connect LLMs to Twitter Automation">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@nichxbt">
  <meta name="twitter:creator" content="@nichxbt">
  <meta name="twitter:title" content="AI Integration - XActions | GPT, Claude & LLM Automation">
  <meta name="twitter:description" content="MCP server for AI agents. Connect ChatGPT, Claude, Cursor to Twitter automation. Build intelligent bots.">
  <meta name="twitter:image" content="https://xactions.app/og-ai.png">
  
  <link rel="canonical" href="https://xactions.app/ai">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">
  
  <!-- Structured Data - SoftwareApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "XActions AI Integration",
    "description": "AI-powered X/Twitter automation platform with MCP server support. Integrate GPT-4, Claude, Cursor, VS Code Copilot and custom LLMs for intelligent Twitter automation, smart follower management, and AI-driven engagement.",
    "url": "https://xactions.app/ai",
    "applicationCategory": "DeveloperApplication",
    "operatingSystem": "Cross-platform",
    "programmingLanguage": ["JavaScript", "TypeScript", "Python"],
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "description": "Free and open-source AI integration"
    },
    "featureList": [
      "MCP Server for AI Agents",
      "GPT-4 Integration",
      "Claude Integration",
      "Cursor AI Support",
      "VS Code Copilot Compatible",
      "Custom LLM Support",
      "20+ Automation Tools",
      "Smart Follower Management",
      "AI Content Moderation",
      "Intelligent Engagement"
    ],
    "softwareRequirements": "Node.js 18+",
    "author": {
      "@type": "Person",
      "name": "nich",
      "url": "https://x.com/nichxbt"
    },
    "publisher": {
      "@type": "Organization",
      "name": "XActions",
      "url": "https://xactions.app"
    }
  }
  </script>
  
  <!-- Structured Data - HowTo for MCP Integration -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Integrate AI Agents with Twitter using XActions MCP Server",
    "description": "Step-by-step guide to connecting GPT, Claude, and other AI agents to Twitter automation using the XActions MCP server.",
    "step": [
      {
        "@type": "HowToStep",
        "name": "Install XActions",
        "text": "Install XActions globally using npm: npm install -g xactions"
      },
      {
        "@type": "HowToStep",
        "name": "Configure MCP Server",
        "text": "Add XActions MCP server to your AI tool's configuration file"
      },
      {
        "@type": "HowToStep",
        "name": "Authenticate with Twitter",
        "text": "Run xactions auth to authenticate with your Twitter account"
      },
      {
        "@type": "HowToStep",
        "name": "Connect AI Agent",
        "text": "Your AI agent can now access Twitter automation tools through MCP"
      }
    ]
  }
  </script>

  <!-- Structured Data - FAQPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is the XActions MCP Server?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The XActions MCP (Model Context Protocol) server is a bridge that allows AI agents like Claude, ChatGPT, and custom LLMs to interact with Twitter automation tools. It exposes 20+ tools for scraping, following, unfollowing, liking, and more."
        }
      },
      {
        "@type": "Question",
        "name": "Which AI tools are compatible with XActions?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "XActions works with ChatGPT/GPT-4, Claude Desktop, Cursor AI, VS Code GitHub Copilot, and any custom AI agent that supports MCP or can make API calls."
        }
      },
      {
        "@type": "Question",
        "name": "Can I build an AI Twitter bot with XActions?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes! XActions provides all the building blocks for AI Twitter bots including scraping, automation primitives, and LLM integration. Combine with any language model to create auto-repliers, content curators, and engagement bots."
        }
      }
    ]
  }
  </script>
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://xactions.app"},{"@type":"ListItem","position":2,"name":"AI Integration","item":"https://xactions.app/ai"}]}
  </script>

  <link rel="stylesheet" href="/css/common.css">
  <style>
    :root {
      --bg-primary: #000000;
      --bg-secondary: #16181c;
      --bg-tertiary: #202327;
      --bg-hover: #1d1f23;
      --accent: #1d9bf0;
      --accent-hover: #1a8cd8;
      --accent-light: rgba(29, 155, 240, 0.1);
      --text-primary: #e7e9ea;
      --text-secondary: #8b8f94;
      --text-link: #1d9bf0;
      --border: #2f3336;
      --success: #00ba7c;
      --warning: #ffad1f;
      --error: #f4212e;
      --purple: #794bc4;
      --purple-light: rgba(121, 75, 196, 0.1);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
    }

    ::-webkit-scrollbar { width: 16px; }
    ::-webkit-scrollbar-track { background: var(--bg-primary); }
    ::-webkit-scrollbar-thumb { background: var(--bg-tertiary); border-radius: 8px; border: 4px solid var(--bg-primary); }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

    .layout {
      display: flex;
      max-width: 1300px;
      margin: 0 auto;
      min-height: 100vh;
    }

    /* Left Sidebar */
    .sidebar-left {
      width: 275px;
      padding: 0 12px;
      position: sticky;
      top: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      border-right: 1px solid var(--border);
    }

    .logo { padding: 12px; margin-bottom: 4px; }
    .logo a {
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      color: var(--text-primary);
      font-size: 1.5rem;
      font-weight: 800;
      padding: 12px;
      border-radius: 9999px;
      transition: background 0.2s;
    }
    .logo a:hover { background: var(--accent-light); }

    nav { flex: 1; }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 12px;
      border-radius: 9999px;
      font-size: 1.25rem;
      color: var(--text-primary);
      text-decoration: none;
      transition: background 0.2s;
      margin-bottom: 4px;
    }
    .nav-item:hover { background: var(--bg-tertiary); }
    .nav-item.active { font-weight: 700; }
    .nav-icon { font-size: 1.5rem; width: 28px; text-align: center; }

    .action-btn {
      width: 90%;
      padding: 16px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 9999px;
      font-size: 1.0625rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s;
      margin: 16px 0;
      text-decoration: none;
      display: block;
      text-align: center;
    }
    .action-btn:hover { background: var(--accent-hover); }

    /* Main Content */
    .main-content {
      flex: 1;
      max-width: 600px;
      border-right: 1px solid var(--border);
    }

    .main-header {
      position: sticky;
      top: 0;
      background: rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 16px;
      z-index: 100;
    }
    .main-header h1 { font-size: 1.25rem; font-weight: 700; }

    .section {
      padding: 24px 16px;
      border-bottom: 1px solid var(--border);
    }

    .section-title {
      font-size: 1.25rem;
      font-weight: 800;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .highlight-box {
      background: var(--accent-light);
      border: 1px solid var(--accent);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
    }
    .highlight-box p { color: var(--text-primary); margin: 0; font-weight: 600; }

    .highlight-box.purple {
      background: var(--purple-light);
      border-color: var(--purple);
    }

    .hero-section {
      padding: 32px 16px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(29, 155, 240, 0.05) 0%, transparent 100%);
    }

    .hero-section h1 {
      font-size: 1.75rem;
      font-weight: 800;
      margin-bottom: 12px;
      line-height: 1.2;
    }

    .hero-section .subtitle {
      font-size: 1.125rem;
      color: var(--text-secondary);
      margin-bottom: 20px;
    }

    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 9999px;
      font-size: 0.875rem;
      color: var(--text-primary);
    }
    .badge.accent {
      background: var(--accent-light);
      border-color: var(--accent);
      color: var(--accent);
    }
    .badge.purple {
      background: var(--purple-light);
      border-color: var(--purple);
      color: var(--purple);
    }

    h3 {
      font-size: 1rem;
      font-weight: 700;
      margin: 20px 0 8px;
      color: var(--text-primary);
    }

    p { color: var(--text-secondary); font-size: 0.9375rem; margin-bottom: 12px; }
    p a { color: var(--accent); text-decoration: none; }
    p a:hover { text-decoration: underline; }

    ul { margin-left: 20px; margin-bottom: 12px; }
    li { color: var(--text-secondary); font-size: 0.9375rem; margin-bottom: 6px; }
    li strong { color: var(--text-primary); }

    .feature-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      transition: all 0.2s;
    }
    .feature-card:hover {
      border-color: var(--accent);
      background: var(--bg-tertiary);
    }
    .feature-card h3 { margin: 0 0 8px; }
    .feature-card p { margin: 0 0 8px; }
    .feature-card ul { margin: 8px 0 0 20px; }

    .tool-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }

    .tool-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      transition: all 0.2s;
    }
    .tool-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
    }
    .tool-card .icon {
      font-size: 2rem;
      margin-bottom: 8px;
    }
    .tool-card h4 {
      font-size: 0.9375rem;
      margin-bottom: 4px;
    }
    .tool-card p {
      font-size: 0.8125rem;
      color: var(--text-secondary);
      margin: 0;
    }

    .code-block {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 16px;
    }
    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border);
    }
    .code-header span {
      font-size: 0.8125rem;
      color: var(--text-secondary);
    }
    .code-header .lang {
      color: var(--accent);
      font-weight: 600;
    }
    .code-content {
      padding: 16px;
      overflow-x: auto;
    }
    .code-content pre {
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
      font-size: 0.8125rem;
      line-height: 1.6;
      color: var(--text-primary);
      margin: 0;
      white-space: pre;
    }
    .code-content .comment { color: var(--text-secondary); }
    .code-content .keyword { color: var(--purple); }
    .code-content .string { color: var(--success); }
    .code-content .property { color: var(--accent); }

    .api-endpoint {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .api-method {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 700;
      font-family: monospace;
    }
    .api-method.get { background: rgba(0, 186, 124, 0.2); color: var(--success); }
    .api-method.post { background: rgba(29, 155, 240, 0.2); color: var(--accent); }
    .api-path {
      font-family: monospace;
      font-size: 0.875rem;
      color: var(--text-primary);
    }

    /* Right Sidebar */
    .sidebar-right {
      width: 350px;
      padding: 12px 24px;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .promo-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      margin-bottom: 16px;
      overflow: hidden;
    }
    .promo-header { padding: 16px; font-size: 1.25rem; font-weight: 800; }
    .promo-item {
      padding: 16px;
      border-top: 1px solid var(--border);
      transition: background 0.2s;
    }
    .promo-item:hover { background: var(--bg-hover); }
    .promo-item h4 { font-size: 0.9375rem; margin-bottom: 4px; }
    .promo-item p { color: var(--text-secondary); font-size: 0.8125rem; margin: 0; }
    .promo-link {
      display: block;
      padding: 16px;
      color: var(--accent);
      font-size: 0.9375rem;
      text-decoration: none;
      transition: background 0.2s;
    }
    .promo-link:hover { background: var(--bg-hover); }

    .disclaimer {
      padding: 16px;
      color: var(--text-secondary);
      font-size: 0.8125rem;
      line-height: 1.5;
    }

    /* Responsive */
    @media (max-width: 1280px) { .sidebar-right { width: 290px; } }
    @media (max-width: 1024px) { .sidebar-right { display: none; } .main-content { max-width: 100%; } }
    @media (max-width: 768px) {
      .sidebar-left { width: 68px; padding: 0 4px; }
      .logo a span:last-child, .nav-item span:last-child { display: none; }
      .nav-item { justify-content: center; padding: 12px; }
      .action-btn { width: 50px; height: 50px; padding: 0; font-size: 0; }
      .action-btn::before { content: '‚Üí'; font-size: 1.5rem; }
      .tool-grid { grid-template-columns: 1fr; }
    }

    /* Footer */
    .site-footer {
      border-top: 1px solid var(--border);
      padding: 48px 24px;
      background: var(--bg-primary);
    }
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap: 32px;
    }
    .footer-section h4 { font-size: 0.875rem; font-weight: 700; margin-bottom: 12px; color: var(--text-primary); }
    .footer-section p { color: var(--text-secondary); font-size: 0.875rem; line-height: 1.5; margin-bottom: 8px; }
    .footer-section a { display: block; color: var(--text-secondary); text-decoration: none; font-size: 0.875rem; padding: 4px 0; transition: color 0.2s; }
    .footer-section a:hover { color: var(--accent); }
    .footer-bottom { max-width: 1200px; margin: 24px auto 0; padding-top: 24px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; }
    .footer-bottom p { color: var(--text-secondary); font-size: 0.8125rem; }
    .footer-bottom a { color: var(--text-secondary); text-decoration: none; }
    .footer-bottom a:hover { color: var(--accent); }
    @media (max-width: 768px) { .footer-content { grid-template-columns: 1fr 1fr; } }
    @media (max-width: 480px) { .footer-content { grid-template-columns: 1fr; } }

    /* Skip Navigation */
    .skip-nav {
      position: absolute;
      top: -100%;
      left: 16px;
      background: var(--accent);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 700;
      z-index: 9999;
      text-decoration: none;
    }
    .skip-nav:focus {
      top: 16px;
    }

    /* Visible focus styles */
    :focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-nav">Skip to main content</a>
  <div class="layout">
    <!-- Left Sidebar -->
    <aside class="sidebar-left" aria-label="Main navigation">
      <div class="logo">
        <a href="/"><span>‚ö°</span><span>XActions</span></a>
      </div>
      <nav>
        <a href="/" class="nav-item" aria-label="Home"><span class="nav-icon" aria-hidden="true">üè†</span><span>Home</span></a>
        <a href="/run" class="nav-item" aria-label="One-Click"><span class="nav-icon" aria-hidden="true">üöÄ</span><span>One-Click</span></a>
        <a href="/dashboard" class="nav-item" aria-label="Dashboard"><span class="nav-icon" aria-hidden="true">üìä</span><span>Dashboard</span></a>
        <a href="/thread" class="nav-item" aria-label="Thread Reader"><span class="nav-icon" aria-hidden="true">üßµ</span><span>Thread Reader</span></a>
        <a href="/video" class="nav-item" aria-label="Video Downloader"><span class="nav-icon" aria-hidden="true">üé¨</span><span>Video DL</span></a>
        <a href="/features" class="nav-item" aria-label="All Scripts"><span class="nav-icon" aria-hidden="true">‚ö°</span><span>All Scripts</span></a>
        <a href="/tutorials" class="nav-item" aria-label="Tutorials"><span class="nav-icon" aria-hidden="true">üìö</span><span>Tutorials</span></a>
        <a href="/docs" class="nav-item" aria-label="Documentation"><span class="nav-icon" aria-hidden="true">üìñ</span><span>Documentation</span></a>
        <a href="/mcp" class="nav-item" aria-label="AI/MCP"><span class="nav-icon" aria-hidden="true">ü§ñ</span><span>AI/MCP</span></a>
        <a href="/pricing" class="nav-item" aria-label="Pricing"><span class="nav-icon" aria-hidden="true">üí∞</span><span>Pricing</span></a>
        <a href="/ai" class="nav-item active" aria-label="AI Features"><span class="nav-icon" aria-hidden="true">üß†</span><span>AI Features</span></a>
        <a href="/about" class="nav-item" aria-label="About"><span class="nav-icon" aria-hidden="true">‚ÑπÔ∏è</span><span>About</span></a>
        <a href="https://github.com/nirholas/XActions" class="nav-item" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><span class="nav-icon" aria-hidden="true">‚≠ê</span><span>GitHub</span></a>
      </nav>
      <a href="https://github.com/nirholas/XActions" class="action-btn" target="_blank" rel="noopener noreferrer">Star on GitHub ‚≠ê</a>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
      <!-- Free & Open Source Banner -->
      <div style="background: linear-gradient(90deg, #00ba7c, #1d9bf0); padding: 12px 20px; border-radius: 12px; margin: 16px; text-align: center;">
        <span style="font-weight: 700;">üß† AI Tweet Writer ‚Äî Powered by Voice Analysis</span>
        <span style="margin-left: 12px; opacity: 0.9;">Scrape ‚Üí Analyze ‚Üí Generate</span>
        <a href="https://github.com/nirholas/XActions" style="margin-left: 12px; color: white; text-decoration: underline;">Star on GitHub ‚≠ê</a>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-nav" style="display: flex; border-bottom: 1px solid var(--border); position: sticky; top: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(12px); z-index: 100;">
        <button class="tab-btn active" data-tab="voice" style="flex: 1; padding: 16px; background: none; border: none; color: var(--text-primary); font-size: 0.9375rem; font-weight: 700; cursor: pointer; border-bottom: 2px solid var(--accent); transition: all 0.2s;">üé≠ Voice Analysis</button>
        <button class="tab-btn" data-tab="generate" style="flex: 1; padding: 16px; background: none; border: none; color: var(--text-secondary); font-size: 0.9375rem; font-weight: 700; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s;">‚úçÔ∏è Generate</button>
        <button class="tab-btn" data-tab="calendar" style="flex: 1; padding: 16px; background: none; border: none; color: var(--text-secondary); font-size: 0.9375rem; font-weight: 700; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s;">üìÖ Calendar</button>
      </div>

      <!-- ==================== TAB 1: Voice Analysis ==================== -->
      <div class="tab-panel active" id="tab-voice">
        <section class="section">
          <h2 class="section-title">üé≠ Analyze Writing Voice</h2>
          <p>Enter a Twitter username to scrape their tweets and analyze their writing style, tone, vocabulary, and content patterns.</p>

          <div class="feature-card" style="margin-top: 16px;">
            <div style="display: flex; gap: 8px; align-items: center;">
              <span style="color: var(--text-secondary); font-size: 1.25rem;">@</span>
              <input type="text" id="voice-username" placeholder="username" style="flex: 1; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; color: var(--text-primary); font-size: 1rem; outline: none;" />
              <button id="btn-analyze-voice" onclick="analyzeVoice()" style="background: var(--accent); color: white; border: none; border-radius: 9999px; padding: 12px 24px; font-weight: 700; cursor: pointer; white-space: nowrap;">Analyze Voice</button>
            </div>
            <p style="margin-top: 8px; font-size: 0.8125rem;">Takes 30-60 seconds to scrape and analyze tweets. Requires auth token.</p>
            <div style="margin-top: 8px; display: flex; gap: 8px; align-items: center;">
              <input type="password" id="voice-auth-token" placeholder="auth_token cookie (from x.com DevTools)" style="flex: 1; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 10px 16px; color: var(--text-primary); font-size: 0.875rem; outline: none;" />
            </div>
          </div>

          <!-- Loading State -->
          <div id="voice-loading" style="display: none; text-align: center; padding: 40px 16px;">
            <div style="font-size: 2rem; animation: pulse 1.5s ease-in-out infinite;">üîç</div>
            <p style="margin-top: 12px; font-weight: 600;">Scraping tweets and analyzing voice...</p>
            <p style="font-size: 0.8125rem;">This may take 30-60 seconds</p>
          </div>

          <!-- Voice Profile Result -->
          <div id="voice-result" style="display: none;">
            <!-- Profile Card -->
            <div class="feature-card" style="margin-top: 16px;">
              <h3 id="voice-profile-title">üìä Voice Profile</h3>
              
              <!-- Tone Radar (text-based) -->
              <div style="margin-top: 16px;">
                <h4 style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 8px;">TONE DIMENSIONS</h4>
                <div id="tone-bars"></div>
              </div>

              <!-- Style Metrics -->
              <div style="margin-top: 20px;">
                <h4 style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 8px;">WRITING STYLE</h4>
                <div id="style-metrics" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;"></div>
              </div>
            </div>

            <!-- Content Pillars -->
            <div class="feature-card" style="margin-top: 12px;">
              <h3>üìå Content Pillars</h3>
              <div id="content-pillars" style="margin-top: 12px;"></div>
            </div>

            <!-- Top Words -->
            <div class="feature-card" style="margin-top: 12px;">
              <h3>üí¨ Top Words</h3>
              <div id="top-words" style="margin-top: 12px; display: flex; flex-wrap: wrap; gap: 6px;"></div>
            </div>

            <!-- Best Performing Traits -->
            <div class="feature-card" style="margin-top: 12px;">
              <h3>üèÜ Best Performing Traits</h3>
              <ul id="best-traits" style="margin-top: 8px;"></ul>
            </div>

            <!-- Top Example Tweets -->
            <div class="feature-card" style="margin-top: 12px;">
              <h3>‚≠ê Top Tweets</h3>
              <div id="top-tweets" style="margin-top: 8px;"></div>
            </div>
          </div>
        </section>
      </div>

      <!-- ==================== TAB 2: Generate ==================== -->
      <div class="tab-panel" id="tab-generate" style="display: none;">
        <section class="section">
          <h2 class="section-title">‚úçÔ∏è Generate Tweets</h2>
          <p>Generate tweets in a user's analyzed voice. Run Voice Analysis first.</p>

          <div class="feature-card" style="margin-top: 16px;">
            <!-- Voice Profile Selector -->
            <div style="margin-bottom: 12px;">
              <label style="font-size: 0.875rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Voice Profile</label>
              <select id="gen-profile" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 10px 16px; color: var(--text-primary); font-size: 0.9375rem; outline: none;">
                <option value="">‚Äî Analyze a voice first ‚Äî</option>
              </select>
            </div>

            <!-- Topic Input -->
            <div style="margin-bottom: 12px;">
              <label style="font-size: 0.875rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Topic / Prompt</label>
              <textarea id="gen-topic" placeholder="e.g., Why shipping fast matters more than perfection" rows="3" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 10px 16px; color: var(--text-primary); font-size: 0.9375rem; outline: none; resize: vertical; font-family: inherit;"></textarea>
            </div>

            <!-- Options Row -->
            <div style="display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
              <div style="flex: 1; min-width: 120px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Type</label>
                <select id="gen-type" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;">
                  <option value="tweet">Single Tweet</option>
                  <option value="thread">Thread (3-10)</option>
                  <option value="reply">Reply</option>
                  <option value="rewrite">Rewrite</option>
                </select>
              </div>
              <div style="flex: 1; min-width: 120px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Style</label>
                <select id="gen-style" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;">
                  <option value="">Auto</option>
                  <option value="hot-take">Hot Take</option>
                  <option value="educational">Educational</option>
                  <option value="personal">Personal</option>
                  <option value="promotional">Promotional</option>
                </select>
              </div>
              <div style="min-width: 80px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Count</label>
                <input type="number" id="gen-count" value="3" min="1" max="5" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;" />
              </div>
            </div>

            <!-- Rewrite Goal (shown when type=rewrite) -->
            <div id="rewrite-options" style="display: none; margin-bottom: 12px;">
              <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Improvement Goal</label>
              <select id="gen-rewrite-goal" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;">
                <option value="more_engaging">More Engaging</option>
                <option value="shorter">Shorter & Punchier</option>
                <option value="add_hook">Add Hook</option>
                <option value="more_casual">More Casual</option>
                <option value="more_formal">More Formal</option>
                <option value="add_cta">Add CTA</option>
              </select>
            </div>

            <!-- Reply Tone (shown when type=reply) -->
            <div id="reply-options" style="display: none; margin-bottom: 12px;">
              <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Reply Tone</label>
              <select id="gen-reply-tone" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;">
                <option value="">Auto</option>
                <option value="agree">Agree</option>
                <option value="disagree">Disagree</option>
                <option value="add-on">Add On</option>
                <option value="question">Question</option>
                <option value="funny">Funny</option>
                <option value="supportive">Supportive</option>
              </select>
            </div>

            <!-- API Key (optional) -->
            <details style="margin-bottom: 12px;">
              <summary style="font-size: 0.8125rem; color: var(--text-secondary); cursor: pointer;">‚öôÔ∏è Advanced: API Key & Model</summary>
              <div style="margin-top: 8px;">
                <input type="password" id="gen-api-key" placeholder="OpenRouter API key (env: OPENROUTER_API_KEY)" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.8125rem; outline: none; margin-bottom: 6px;" />
                <input type="text" id="gen-model" placeholder="Model (default: google/gemini-flash-2.0)" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.8125rem; outline: none;" />
              </div>
            </details>

            <button id="btn-generate" onclick="generateContent()" style="width: 100%; background: var(--accent); color: white; border: none; border-radius: 9999px; padding: 14px; font-weight: 700; font-size: 1rem; cursor: pointer;">‚ú® Generate</button>
          </div>

          <!-- Loading -->
          <div id="gen-loading" style="display: none; text-align: center; padding: 40px 16px;">
            <div style="font-size: 2rem; animation: pulse 1.5s ease-in-out infinite;">‚ú®</div>
            <p style="margin-top: 12px; font-weight: 600;">Generating content...</p>
          </div>

          <!-- Results -->
          <div id="gen-results" style="display: none;"></div>
        </section>
      </div>

      <!-- ==================== TAB 3: Content Calendar ==================== -->
      <div class="tab-panel" id="tab-calendar" style="display: none;">
        <section class="section">
          <h2 class="section-title">üìÖ Content Calendar</h2>
          <p>Generate a full week of tweets. Click any slot to regenerate.</p>

          <div class="feature-card" style="margin-top: 16px;">
            <div style="display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
              <div style="flex: 1; min-width: 120px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Voice Profile</label>
                <select id="cal-profile" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;">
                  <option value="">‚Äî Analyze a voice first ‚Äî</option>
                </select>
              </div>
              <div style="flex: 1; min-width: 80px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Days</label>
                <input type="number" id="cal-days" value="7" min="1" max="14" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;" />
              </div>
              <div style="flex: 1; min-width: 80px;">
                <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Posts/Day</label>
                <input type="number" id="cal-ppd" value="2" min="1" max="5" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; color: var(--text-primary); font-size: 0.875rem; outline: none;" />
              </div>
            </div>

            <div style="margin-bottom: 12px;">
              <label style="font-size: 0.8125rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">Topics (comma-separated, optional)</label>
              <input type="text" id="cal-topics" placeholder="e.g., tech, startups, AI" style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 10px 16px; color: var(--text-primary); font-size: 0.9375rem; outline: none;" />
            </div>

            <button id="btn-calendar" onclick="generateCalendar()" style="width: 100%; background: var(--accent); color: white; border: none; border-radius: 9999px; padding: 14px; font-weight: 700; font-size: 1rem; cursor: pointer;">üìÖ Generate Calendar</button>
          </div>

          <!-- Loading -->
          <div id="cal-loading" style="display: none; text-align: center; padding: 40px 16px;">
            <div style="font-size: 2rem; animation: pulse 1.5s ease-in-out infinite;">üìÖ</div>
            <p style="margin-top: 12px; font-weight: 600;">Generating content calendar...</p>
          </div>

          <!-- Calendar Grid -->
          <div id="cal-grid" style="display: none; margin-top: 16px;"></div>

          <!-- Export Buttons -->
          <div id="cal-export" style="display: none; padding: 16px; display: flex; gap: 8px; justify-content: flex-end;">
            <button onclick="exportCalendar('json')" style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 16px; color: var(--text-primary); font-size: 0.875rem; cursor: pointer;">Export JSON</button>
            <button onclick="exportCalendar('csv')" style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; padding: 8px 16px; color: var(--text-primary); font-size: 0.875rem; cursor: pointer;">Export CSV</button>
          </div>
        </section>
      </div>

      <!-- Info Section (collapsed, for reference) -->
      <section class="section">
        <details>
          <summary style="cursor: pointer; font-weight: 700; font-size: 1.125rem;">‚ÑπÔ∏è How It Works</summary>
          <div style="margin-top: 16px;">
            <div class="feature-card">
              <h3>Step 1: Analyze Voice</h3>
              <p>Scrapes a user's tweet history and extracts patterns: writing style, tone, vocabulary, content pillars, and engagement correlations.</p>
            </div>
            <div class="feature-card" style="margin-top: 8px;">
              <h3>Step 2: Generate Content</h3>
              <p>Uses the voice profile as context for an LLM (via OpenRouter) to generate tweets that match the user's exact voice and style.</p>
            </div>
            <div class="feature-card" style="margin-top: 8px;">
              <h3>üî• Killer Feature</h3>
              <p>Scrape a competitor's tweets ‚Üí analyze what works ‚Üí generate your own tweets that match the winning patterns but in YOUR voice.</p>
            </div>
          </div>
        </details>
      </section>
    </main>

    <!-- Right Sidebar -->
    <aside class="sidebar-right" aria-label="Supplementary information">
      <div class="promo-card">
        <h3 class="promo-header">ÔøΩ AI Writer</h3>
        <div class="promo-item">
          <h4>Voice Analysis</h4>
          <p>Scrape tweets ‚Üí analyze writing style</p>
        </div>
        <div class="promo-item">
          <h4>Tweet Generation</h4>
          <p>Generate tweets in any voice</p>
        </div>
        <div class="promo-item">
          <h4>Content Calendar</h4>
          <p>Plan a full week of content</p>
        </div>
        <a href="https://github.com/nirholas/XActions" target="_blank" class="promo-link">View Source ‚Üí</a>
      </div>

      <div class="promo-card">
        <h3 class="promo-header">üî• Killer Feature</h3>
        <div class="promo-item">
          <h4>Competitor Analysis</h4>
          <p>Scrape competitor tweets ‚Üí analyze what works ‚Üí generate in YOUR voice</p>
        </div>
      </div>

      <div class="promo-card">
        <h3 class="promo-header">‚ö° API Endpoints</h3>
        <div class="promo-item">
          <h4>POST /api/ai/writer/analyze-voice</h4>
          <p>Analyze writing voice</p>
        </div>
        <div class="promo-item">
          <h4>POST /api/ai/writer/generate</h4>
          <p>Generate tweets</p>
        </div>
        <div class="promo-item">
          <h4>POST /api/ai/writer/rewrite</h4>
          <p>Improve a tweet</p>
        </div>
        <a href="/docs" class="promo-link">Full API Docs ‚Üí</a>
      </div>

      <div class="disclaimer">
        <p>AI Tweet Writer requires an OpenRouter API key for generation. Voice analysis is free (scraping only).</p>
        <p style="margin-top: 8px;">¬© 2026 XActions ‚Äî by <a href="https://x.com/nichxbt">@nichxbt</a></p>
      </div>
    </aside>
  </div>

  <!-- ==================== JavaScript ==================== -->
  <script>
    // ====== State ======
    const API_BASE = window.location.origin;
    let savedProfiles = {};
    let currentCalendar = null;

    // ====== Tab Navigation ======
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => {
          b.style.color = 'var(--text-secondary)';
          b.style.borderBottom = '2px solid transparent';
          b.classList.remove('active');
        });
        btn.style.color = 'var(--text-primary)';
        btn.style.borderBottom = '2px solid var(--accent)';
        btn.classList.add('active');

        document.querySelectorAll('.tab-panel').forEach(p => p.style.display = 'none');
        document.getElementById('tab-' + btn.dataset.tab).style.display = 'block';
      });
    });

    // Show/hide rewrite/reply options based on type
    document.getElementById('gen-type').addEventListener('change', (e) => {
      document.getElementById('rewrite-options').style.display = e.target.value === 'rewrite' ? 'block' : 'none';
      document.getElementById('reply-options').style.display = e.target.value === 'reply' ? 'block' : 'none';
    });

    // ====== Voice Analysis ======
    async function analyzeVoice() {
      const username = document.getElementById('voice-username').value.trim().replace(/^@/, '');
      const authToken = document.getElementById('voice-auth-token').value.trim();

      if (!username) return alert('Enter a username');
      if (!authToken) return alert('Enter your auth_token cookie');

      document.getElementById('voice-loading').style.display = 'block';
      document.getElementById('voice-result').style.display = 'none';

      try {
        const res = await fetch(`${API_BASE}/api/ai/writer/analyze-voice`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, authToken, tweetLimit: 200 }),
        });
        const data = await res.json();

        if (!data.success) throw new Error(data.error || data.message || 'Analysis failed');

        const profile = data.data.profile;
        savedProfiles[username.toLowerCase()] = profile;
        renderVoiceProfile(profile);
        updateProfileSelectors();
      } catch (err) {
        alert('Error: ' + err.message);
      } finally {
        document.getElementById('voice-loading').style.display = 'none';
      }
    }

    function renderVoiceProfile(profile) {
      document.getElementById('voice-result').style.display = 'block';
      document.getElementById('voice-profile-title').textContent = `üìä Voice Profile: @${profile.username} (${profile.tweetCount} tweets)`;

      // Tone bars
      const toneBars = document.getElementById('tone-bars');
      toneBars.innerHTML = '';
      const tones = [
        { label: 'Formality', value: profile.tone.formality, color: '#1d9bf0' },
        { label: 'Humor', value: profile.tone.humor, color: '#ffad1f' },
        { label: 'Controversy', value: profile.tone.controversy, color: '#f4212e' },
        { label: 'Technicality', value: profile.tone.technicality, color: '#794bc4' },
      ];
      for (const t of tones) {
        toneBars.innerHTML += `
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
            <span style="width: 100px; font-size: 0.8125rem; color: var(--text-secondary);">${t.label}</span>
            <div style="flex: 1; background: var(--bg-tertiary); border-radius: 4px; height: 8px; overflow: hidden;">
              <div style="width: ${Math.round(t.value * 100)}%; height: 100%; background: ${t.color}; border-radius: 4px; transition: width 0.5s;"></div>
            </div>
            <span style="width: 36px; font-size: 0.75rem; color: var(--text-secondary); text-align: right;">${Math.round(t.value * 100)}%</span>
          </div>`;
      }

      // Style metrics
      const styleMetrics = document.getElementById('style-metrics');
      const s = profile.style;
      const metrics = [
        { label: 'Avg Length', value: s.avgLength + ' chars' },
        { label: 'Emoji/tweet', value: s.emojiRate.toFixed(2) },
        { label: 'Hashtag/tweet', value: s.hashtagRate.toFixed(2) },
        { label: 'Question Rate', value: Math.round(s.questionRate * 100) + '%' },
        { label: 'Thread Rate', value: Math.round(s.threadRate * 100) + '%' },
        { label: 'Link Rate', value: Math.round(s.urlRate * 100) + '%' },
      ];
      styleMetrics.innerHTML = metrics.map(m => `
        <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 10px 12px;">
          <div style="font-size: 0.75rem; color: var(--text-secondary);">${m.label}</div>
          <div style="font-size: 1.125rem; font-weight: 700; margin-top: 2px;">${m.value}</div>
        </div>`).join('');

      // Content pillars
      const pillarsEl = document.getElementById('content-pillars');
      if (profile.contentPillars.length > 0) {
        pillarsEl.innerHTML = profile.contentPillars.map(p => `
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
            <span style="width: 80px; font-size: 0.875rem; font-weight: 600; text-transform: capitalize;">${p.topic}</span>
            <div style="flex: 1; background: var(--bg-tertiary); border-radius: 4px; height: 8px; overflow: hidden;">
              <div style="width: ${Math.round(p.frequency * 100)}%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
            </div>
            <span style="font-size: 0.75rem; color: var(--text-secondary);">${Math.round(p.frequency * 100)}%</span>
          </div>`).join('');
      } else {
        pillarsEl.innerHTML = '<p>No strong topic clusters detected</p>';
      }

      // Top words
      const wordsEl = document.getElementById('top-words');
      wordsEl.innerHTML = profile.vocabulary.topWords.slice(0, 20).map(w => {
        const size = Math.min(1.5, 0.75 + w.count * 0.05);
        return `<span style="background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 9999px; padding: 4px 10px; font-size: ${size}rem;">${w.word}</span>`;
      }).join('');

      // Best traits
      const traitsEl = document.getElementById('best-traits');
      if (profile.bestPerforming.commonTraits.length > 0) {
        traitsEl.innerHTML = profile.bestPerforming.commonTraits.map(t => `<li>${t}</li>`).join('');
      } else {
        traitsEl.innerHTML = '<li>Not enough data for trait analysis</li>';
      }

      // Top tweets
      const tweetsEl = document.getElementById('top-tweets');
      if (profile.bestPerforming.examples.length > 0) {
        tweetsEl.innerHTML = profile.bestPerforming.examples.map(t => `
          <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 12px; margin-bottom: 8px;">
            <p style="color: var(--text-primary); margin-bottom: 6px;">${escapeHTML(t.text)}</p>
            <div style="display: flex; gap: 16px; font-size: 0.75rem; color: var(--text-secondary);">
              <span>‚ù§Ô∏è ${t.likes}</span><span>üîÅ ${t.retweets}</span><span>üí¨ ${t.replies}</span>
            </div>
          </div>`).join('');
      } else {
        tweetsEl.innerHTML = '<p>No examples available</p>';
      }
    }

    // ====== Generate Content ======
    async function generateContent() {
      const profileKey = document.getElementById('gen-profile').value;
      const topic = document.getElementById('gen-topic').value.trim();
      const type = document.getElementById('gen-type').value;
      const style = document.getElementById('gen-style').value;
      const count = parseInt(document.getElementById('gen-count').value) || 3;
      const apiKey = document.getElementById('gen-api-key').value.trim();
      const model = document.getElementById('gen-model').value.trim();

      if (!profileKey) return alert('Select a voice profile first');
      if (!topic) return alert('Enter a topic or prompt');

      const voiceProfile = savedProfiles[profileKey];
      if (!voiceProfile) return alert('Voice profile not found. Run analysis first.');

      document.getElementById('gen-loading').style.display = 'block';
      document.getElementById('gen-results').style.display = 'none';

      try {
        let endpoint, body;

        if (type === 'rewrite') {
          endpoint = '/api/ai/writer/rewrite';
          body = { username: profileKey, text: topic, goal: document.getElementById('gen-rewrite-goal').value, count, apiKey: apiKey || undefined, model: model || undefined, voiceProfile };
        } else if (type === 'reply') {
          endpoint = '/api/ai/writer/reply';
          body = { username: profileKey, originalTweet: topic, tone: document.getElementById('gen-reply-tone').value || undefined, count, apiKey: apiKey || undefined, model: model || undefined, voiceProfile };
        } else if (type === 'thread') {
          endpoint = '/api/ai/writer/generate';
          body = { username: profileKey, topic, type: 'thread', threadLength: count, apiKey: apiKey || undefined, model: model || undefined, voiceProfile };
        } else {
          endpoint = '/api/ai/writer/generate';
          body = { username: profileKey, topic, style: style || undefined, count, apiKey: apiKey || undefined, model: model || undefined, voiceProfile };
        }

        const res = await fetch(`${API_BASE}${endpoint}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body),
        });
        const data = await res.json();

        if (!data.success) throw new Error(data.error || data.message || 'Generation failed');

        renderGenResults(data.data, type);
      } catch (err) {
        alert('Error: ' + err.message);
      } finally {
        document.getElementById('gen-loading').style.display = 'none';
      }
    }

    function renderGenResults(data, type) {
      const el = document.getElementById('gen-results');
      el.style.display = 'block';

      let items = [];
      if (type === 'thread') {
        items = (data.thread || []).map(t => ({ text: t.text, meta: t.purpose || `Position ${t.position}` }));
      } else if (type === 'rewrite') {
        items = (data.rewrites || []).map(r => ({ text: r.text, meta: r.improvement }));
      } else if (type === 'reply') {
        items = (data.replies || []).map(r => ({ text: r.text, meta: `${r.tone} ‚Äî ${r.reasoning}` }));
      } else {
        items = (data.tweets || []).map(t => ({ text: t.text, meta: `${t.estimatedEngagement} engagement ‚Äî ${t.reasoning}` }));
      }

      el.innerHTML = `<div style="padding: 16px;">
        <h3 style="margin-bottom: 12px;">‚ú® Generated ${items.length} ${type === 'thread' ? 'thread tweets' : 'variations'}${data.model ? ` <span style="font-size: 0.75rem; color: var(--text-secondary);">(${data.model})</span>` : ''}</h3>
        ${items.map((item, i) => `
          <div class="feature-card" style="margin-bottom: 8px; position: relative;">
            <p style="color: var(--text-primary); font-size: 1rem; margin-bottom: 8px; white-space: pre-wrap;">${escapeHTML(item.text)}</p>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="font-size: 0.75rem; color: var(--text-secondary);">${escapeHTML(item.meta || '')}</span>
              <div style="display: flex; gap: 6px;">
                <button onclick="copyTweet(this, ${JSON.stringify(item.text).replace(/"/g, '&quot;')})" style="background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 4px 12px; color: var(--text-primary); font-size: 0.75rem; cursor: pointer;">üìã Copy</button>
                <button onclick="rateTweet(this, 'up')" style="background: none; border: none; cursor: pointer; font-size: 1rem;" title="Good">üëç</button>
                <button onclick="rateTweet(this, 'down')" style="background: none; border: none; cursor: pointer; font-size: 1rem;" title="Bad">üëé</button>
              </div>
            </div>
          </div>
        `).join('')}
      </div>`;
    }

    // ====== Content Calendar ======
    async function generateCalendar() {
      const profileKey = document.getElementById('cal-profile').value;
      const days = parseInt(document.getElementById('cal-days').value) || 7;
      const postsPerDay = parseInt(document.getElementById('cal-ppd').value) || 2;
      const topicsStr = document.getElementById('cal-topics').value.trim();
      const topics = topicsStr ? topicsStr.split(',').map(t => t.trim()).filter(Boolean) : undefined;

      if (!profileKey) return alert('Select a voice profile first');

      const voiceProfile = savedProfiles[profileKey];
      if (!voiceProfile) return alert('Voice profile not found');

      document.getElementById('cal-loading').style.display = 'block';
      document.getElementById('cal-grid').style.display = 'none';

      try {
        const res = await fetch(`${API_BASE}/api/ai/writer/calendar`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username: profileKey, topics, postsPerDay, days, voiceProfile }),
        });
        const data = await res.json();

        if (!data.success) throw new Error(data.error || data.message || 'Calendar generation failed');

        currentCalendar = data.data.calendar;
        renderCalendar(currentCalendar);
      } catch (err) {
        alert('Error: ' + err.message);
      } finally {
        document.getElementById('cal-loading').style.display = 'none';
      }
    }

    function renderCalendar(calendar) {
      const el = document.getElementById('cal-grid');
      el.style.display = 'block';
      document.getElementById('cal-export').style.display = 'flex';

      // Group by day
      const byDay = {};
      for (const item of calendar) {
        if (!byDay[item.day]) byDay[item.day] = [];
        byDay[item.day].push(item);
      }

      el.innerHTML = Object.entries(byDay).map(([day, items]) => `
        <div style="border-bottom: 1px solid var(--border); padding: 16px;">
          <h3 style="margin-bottom: 8px; color: var(--accent);">${day}</h3>
          ${items.map(item => `
            <div class="feature-card" style="margin-bottom: 6px;">
              <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 6px;">
                <span class="badge" style="font-size: 0.6875rem;">${item.slot || ''}</span>
                <span class="badge accent" style="font-size: 0.6875rem;">${item.type || 'single'}</span>
              </div>
              <p style="color: var(--text-primary); margin-bottom: 6px;">${escapeHTML(item.text)}</p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-size: 0.75rem; color: var(--text-secondary);">${escapeHTML(item.topic || '')}</span>
                <button onclick="copyTweet(this, ${JSON.stringify(item.text).replace(/"/g, '&quot;')})" style="background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; padding: 4px 12px; color: var(--text-primary); font-size: 0.75rem; cursor: pointer;">üìã Copy</button>
              </div>
            </div>
          `).join('')}
        </div>
      `).join('');
    }

    function exportCalendar(format) {
      if (!currentCalendar) return;
      let content, filename, type;

      if (format === 'csv') {
        const rows = [['Day', 'Slot', 'Topic', 'Type', 'Text']];
        for (const item of currentCalendar) {
          rows.push([item.day, item.slot, item.topic, item.type, `"${(item.text || '').replace(/"/g, '""')}"`]);
        }
        content = rows.map(r => r.join(',')).join('\n');
        filename = 'xactions-calendar.csv';
        type = 'text/csv';
      } else {
        content = JSON.stringify(currentCalendar, null, 2);
        filename = 'xactions-calendar.json';
        type = 'application/json';
      }

      const blob = new Blob([content], { type });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }

    // ====== Helpers ======
    function updateProfileSelectors() {
      const options = Object.keys(savedProfiles).map(k => `<option value="${k}">@${k}</option>`).join('');
      const placeholder = '<option value="">‚Äî Select voice profile ‚Äî</option>';
      document.getElementById('gen-profile').innerHTML = placeholder + options;
      document.getElementById('cal-profile').innerHTML = placeholder + options;
    }

    function copyTweet(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = '‚úÖ Copied!';
        setTimeout(() => btn.textContent = 'üìã Copy', 2000);
      });
    }

    function rateTweet(btn, direction) {
      btn.style.opacity = '0.5';
      btn.disabled = true;
      // Future: send rating to API for feedback loop
    }

    function escapeHTML(str) {
      if (!str) return '';
      return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
    }
  </script>

  <style>
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.1); }
    }
  </style>

  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>XActions</h4>
        <p>100% Free & Open Source X/Twitter Automation</p>
        <p>Created by <a href="https://x.com/nichxbt" rel="noopener">@nichxbt</a></p>
      </div>
      <div class="footer-section">
        <h4>Product</h4>
        <a href="/features">Features</a>
        <a href="/pricing">Pricing</a>
        <a href="/run">Run Scripts</a>
        <a href="/dashboard">Dashboard</a>
        <a href="/automations">Automations</a>
        <a href="/workflows">Workflows</a>
        <a href="/analytics">Analytics</a>
        <a href="/monitor">Monitor</a>
      </div>
      <div class="footer-section">
        <h4>AI & Developers</h4>
        <a href="/ai">AI Integration</a>
        <a href="/ai-api">AI API (x402)</a>
        <a href="/mcp">MCP Server</a>
        <a href="/docs">Documentation</a>
        <a href="/tutorials">Tutorials</a>
      </div>
      <div class="footer-section">
        <h4>Community</h4>
        <a href="https://github.com/nirholas/XActions" rel="noopener">GitHub</a>
        <a href="https://github.com/nirholas/XActions/issues" rel="noopener">Report Issues</a>
        <a href="/about">About</a>
        <a href="/terms">Terms</a>
        <a href="/privacy">Privacy</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© 2024-2026 XActions. MIT License. No API fees. No limits.</p>
    </div>
  </footer>
</body>
</html>
