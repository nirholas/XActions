<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - XActions | AI-Powered X/Twitter Automation Platform</title>
  <meta name="description" content="XActions Dashboard - AI-powered X/Twitter automation control center. Smart unfollow with machine learning, LLM integration, MCP server support. Manage automation with GPT & Claude compatible tools.">
  <meta name="keywords" content="xactions dashboard, AI Twitter automation, LLM Twitter bot, machine learning Twitter, AI agents for X, GPT Twitter automation, Claude Twitter tools, MCP server Twitter, AI-powered unfollow, smart Twitter automation, twitter automation, twitter unfollow tool, mass unfollow twitter, twitter growth, twitter bot">
  <meta name="author" content="nich (@nichxbt)">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="XActions Dashboard - AI-Powered Automation Control Center">
  <meta property="og:description" content="AI-powered X/Twitter automation platform with LLM integration. Compatible with GPT, Claude & MCP servers. Free, open-source, no API fees.">
  <meta property="og:url" content="https://xactions.app/dashboard">
  <meta property="og:site_name" content="XActions">
  <meta property="og:image" content="https://xactions.app/og-dashboard.png">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@nichxbt">
  <meta name="twitter:creator" content="@nichxbt">
  <meta name="twitter:title" content="XActions Dashboard - AI Automation">
  <meta name="twitter:description" content="AI-powered X/Twitter automation dashboard with LLM & MCP server integration.">
  
  <link rel="canonical" href="https://xactions.app/dashboard">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">
  
  <!-- Socket.io for real-time browser-to-browser communication (loaded only when logged in) -->
  <script>
    if (localStorage.getItem('authToken')) {
      var s = document.createElement('script');
      s.src = 'https://cdn.socket.io/4.7.2/socket.io.min.js';
      document.head.appendChild(s);
    }
  </script>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "XActions Dashboard",
    "description": "AI-powered X/Twitter automation control center with LLM integration. Compatible with GPT, Claude, MCP servers for intelligent unfollowing, monitoring, and growth",
    "url": "https://xactions.app/dashboard",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://xactions.app"},{"@type":"ListItem","position":2,"name":"Dashboard","item":"https://xactions.app/dashboard"}]}
  </script>
  <link rel="stylesheet" href="/css/common.css">
  <style>
    :root {
      --bg-primary: #000000;
      --bg-secondary: #16181c;
      --bg-tertiary: #202327;
      --bg-hover: #1d1f23;
      --accent: #1d9bf0;
      --accent-hover: #1a8cd8;
      --accent-light: rgba(29, 155, 240, 0.1);
      --text-primary: #e7e9ea;
      --text-secondary: #8b8f94;
      --text-link: #1d9bf0;
      --border: #2f3336;
      --success: #00ba7c;
      --warning: #ffad1f;
      --error: #f4212e;
      --verified: #1d9bf0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* WCAG 1.4.1: Links distinguishable by more than color */
    main a:not(.nav-item):not(.action-btn):not(.btn-primary):not(.btn-secondary):not(.operation-card):not(.show-more):not(.tutorial-card),
    .legal-banner a,
    .disclaimer a,
    footer a {
      text-decoration: underline;
      text-decoration-color: var(--accent);
      text-underline-offset: 2px;
    }
    main a:not(.nav-item):not(.action-btn):not(.btn-primary):not(.btn-secondary):not(.operation-card):not(.show-more):not(.tutorial-card):hover,
    .legal-banner a:hover,
    .disclaimer a:hover,
    footer a:hover {
      text-decoration-color: var(--text-primary);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.5;
      min-height: 100vh;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 16px;
    }
    ::-webkit-scrollbar-track {
      background: var(--bg-primary);
    }
    ::-webkit-scrollbar-thumb {
      background: var(--bg-tertiary);
      border-radius: 8px;
      border: 4px solid var(--bg-primary);
    }
    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-secondary);
    }

    /* Three Column Layout */
    .layout {
      display: flex;
      max-width: 1300px;
      margin: 0 auto;
      min-height: 100vh;
    }

    /* Left Sidebar */
    .sidebar-left {
      width: 275px;
      padding: 0 12px;
      position: sticky;
      top: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      border-right: 1px solid var(--border);
    }

    .logo {
      padding: 8px 12px;
      margin-bottom: 4px;
    }

    .logo a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      color: var(--text-primary);
      font-size: 1.8rem;
      padding: 12px;
      border-radius: 9999px;
      transition: background 0.2s;
      line-height: 1;
    }

    .logo a:hover {
      background: var(--accent-light);
    }

    .logo-icon {
      font-size: 1.75rem;
      line-height: 1;
    }

    /* Navigation */
    nav {
      flex: 1;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 12px;
      border-radius: 9999px;
      font-size: 1.25rem;
      font-weight: 400;
      color: var(--text-primary);
      text-decoration: none;
      transition: background 0.2s;
      margin-bottom: 4px;
    }

    .nav-item:hover {
      background: var(--bg-tertiary);
    }

    .nav-item.active {
      font-weight: 700;
    }

    .nav-icon {
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .nav-icon svg {
      width: 26px;
      height: 26px;
    }

    .nav-item.active .nav-icon svg {
      stroke-width: 2.5;
    }

    .action-btn {
      width: 90%;
      padding: 16px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 9999px;
      font-size: 1.0625rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s;
      margin: 16px 0;
    }

    .action-btn:hover {
      background: var(--accent-hover);
    }

    /* User Menu */
    .user-menu {
      padding: 12px;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: background 0.2s;
      margin-bottom: 12px;
    }

    .user-menu:hover {
      background: var(--bg-tertiary);
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent) 0%, #7856ff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.1rem;
    }

    .user-info {
      flex: 1;
      min-width: 0;
    }

    .user-name {
      font-weight: 700;
      font-size: 0.9375rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-handle {
      color: var(--text-secondary);
      font-size: 0.9375rem;
    }

    .user-menu-dots {
      color: var(--text-primary);
      font-size: 1.2rem;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      max-width: 600px;
      border-right: 1px solid var(--border);
      min-height: 100vh;
    }

    .main-header {
      position: sticky;
      top: 0;
      background: rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 0 16px;
      z-index: 100;
    }

    .header-title {
      padding: 12px 0;
    }

    .header-title h1 {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .header-title p {
      font-size: 0.8125rem;
      color: var(--text-secondary);
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
    }

    .tab {
      flex: 1;
      padding: 16px 0;
      text-align: center;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .tab:hover {
      background: var(--bg-tertiary);
    }

    .tab.active {
      font-weight: 700;
      color: var(--text-primary);
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 56px;
      height: 4px;
      background: var(--accent);
      border-radius: 9999px;
    }

    /* Connection Card */
    .connect-card {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .connect-card.connected {
      background: linear-gradient(135deg, rgba(0, 186, 124, 0.1) 0%, rgba(29, 155, 240, 0.1) 100%);
    }

    .connect-inner {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border);
    }

    .connect-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .connect-icon {
      font-size: 2rem;
    }

    .connect-title {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .connect-desc {
      color: var(--text-secondary);
      font-size: 0.9375rem;
      margin-bottom: 16px;
    }

    .auth-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .auth-tab {
      flex: 1;
      padding: 10px 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: 9999px;
      color: var(--text-primary);
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .auth-tab:hover {
      background: var(--bg-hover);
    }

    .auth-tab.active {
      background: var(--accent);
      border-color: var(--accent);
    }

    .auth-content {
      display: none;
    }

    .auth-content.active {
      display: block;
    }

    .input-group {
      margin-bottom: 12px;
    }

    .input-group textarea,
    .input-group input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 0.9375rem;
      font-family: inherit;
      resize: vertical;
    }

    .input-group textarea {
      min-height: 80px;
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 0.8125rem;
    }

    .input-group textarea:focus,
    .input-group input:focus {
      outline: 2px solid var(--accent);
      outline-offset: -1px;
      border-color: var(--accent);
    }

    .btn-primary {
      width: 100%;
      padding: 12px 24px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 9999px;
      font-size: 0.9375rem;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-primary:hover {
      background: var(--accent-hover);
    }

    .btn-secondary {
      padding: 8px 16px;
      background: transparent;
      color: var(--text-primary);
      border: 1px solid var(--border);
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-secondary:hover {
      background: var(--bg-tertiary);
      border-color: var(--text-secondary);
    }

    .help-link {
      display: block;
      text-align: center;
      color: var(--text-link);
      font-size: 0.8125rem;
      margin-top: 12px;
      text-decoration: none;
    }

    .help-link:hover {
      text-decoration: underline;
    }

    /* Operation Cards */
    .operations-section {
      padding: 16px;
      border-bottom: 1px solid var(--border);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .section-title {
      font-size: 1.25rem;
      font-weight: 800;
    }

    .operation-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .operation-card:hover {
      background: var(--bg-tertiary);
      border-color: var(--accent);
    }

    .operation-header {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }

    .operation-icon {
      font-size: 2rem;
      line-height: 1;
    }

    .operation-info {
      flex: 1;
    }

    .operation-title {
      font-weight: 700;
      font-size: 0.9375rem;
      margin-bottom: 4px;
    }

    .operation-desc {
      color: var(--text-secondary);
      font-size: 0.8125rem;
      line-height: 1.4;
    }

    .operation-cost {
      background: var(--accent);
      color: white;
      padding: 4px 12px;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 700;
      white-space: nowrap;
    }

    /* Activity Feed */
    .activity-section {
      padding: 0;
    }

    .activity-item {
      display: flex;
      gap: 12px;
      padding: 16px;
      border-bottom: 1px solid var(--border);
      transition: background 0.2s;
    }

    .activity-item:hover {
      background: var(--bg-secondary);
    }

    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      flex-shrink: 0;
    }

    .activity-content {
      flex: 1;
      min-width: 0;
    }

    .activity-text {
      font-size: 0.9375rem;
      margin-bottom: 4px;
    }

    .activity-time {
      color: var(--text-secondary);
      font-size: 0.8125rem;
    }

    .activity-status {
      padding: 4px 12px;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 700;
    }

    .status-completed {
      background: rgba(0, 186, 124, 0.2);
      color: var(--success);
    }

    .status-processing {
      background: rgba(255, 173, 31, 0.2);
      color: var(--warning);
    }

    .status-failed {
      background: rgba(244, 33, 46, 0.2);
      color: var(--error);
    }

    .status-pending {
      background: var(--bg-tertiary);
      color: var(--text-secondary);
    }

    /* Right Sidebar */
    .sidebar-right {
      width: 350px;
      padding: 0 24px;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    /* Search */
    .search-box {
      position: sticky;
      top: 0;
      background: var(--bg-primary);
      padding: 12px 0;
      z-index: 10;
    }

    .search-input-wrapper {
      position: relative;
    }

    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .search-input {
      width: 100%;
      padding: 12px 16px 12px 48px;
      background: var(--bg-secondary);
      border: 1px solid transparent;
      border-radius: 9999px;
      color: var(--text-primary);
      font-size: 0.9375rem;
    }

    .search-input:focus {
      outline: 2px solid var(--accent);
      outline-offset: -1px;
      background: var(--bg-primary);
      border-color: var(--accent);
    }

    .search-input::placeholder {
      color: var(--text-secondary);
    }

    /* Stats Card */
    .stats-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      margin-bottom: 16px;
      overflow: hidden;
    }

    .stats-header {
      padding: 12px 16px;
      font-size: 1.25rem;
      font-weight: 800;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      transition: background 0.2s;
    }

    .stat-row:hover {
      background: var(--bg-hover);
    }

    .stat-label {
      color: var(--text-secondary);
      font-size: 0.9375rem;
    }

    .stat-value {
      font-weight: 700;
      font-size: 0.9375rem;
      color: var(--accent);
    }

    /* Who to follow / Tips */
    .tips-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      margin-bottom: 16px;
      overflow: hidden;
    }

    .tips-header {
      padding: 12px 16px;
      font-size: 1.25rem;
      font-weight: 800;
    }

    .tip-item {
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      transition: background 0.2s;
    }

    .tip-item:hover {
      background: var(--bg-hover);
    }

    .tip-title {
      font-weight: 700;
      font-size: 0.9375rem;
      margin-bottom: 4px;
    }

    .tip-desc {
      color: var(--text-secondary);
      font-size: 0.8125rem;
    }

    .show-more {
      display: block;
      padding: 16px;
      color: var(--accent);
      font-size: 0.9375rem;
      text-decoration: none;
      transition: background 0.2s;
    }

    .show-more:hover {
      background: var(--bg-hover);
    }

    /* Disclaimer Footer */
    .disclaimer {
      padding: 12px 16px;
      color: var(--text-secondary);
      font-size: 0.8125rem;
      line-height: 1.4;
    }

    .disclaimer a {
      color: var(--text-secondary);
    }

    .disclaimer a:hover {
      text-decoration: underline;
    }

    .disclaimer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 4px 12px;
      margin-bottom: 8px;
    }

    /* Legal Banner */
    .legal-banner {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 16px;
      margin: 16px;
      font-size: 0.75rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .legal-banner strong {
      color: var(--warning);
    }

    /* Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(91, 112, 131, 0.4);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--bg-primary);
      border-radius: 16px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.8);
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 16px;
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      background: var(--bg-primary);
      z-index: 10;
    }

    .modal-close {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: 1.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .modal-close:hover {
      background: var(--bg-tertiary);
    }

    .modal-title {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .modal-body {
      padding: 24px 16px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 0.9375rem;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 1rem;
    }

    .form-input:focus {
      outline: 2px solid var(--accent);
      outline-offset: -1px;
      border-color: var(--accent);
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-secondary);
      border-radius: 8px;
      cursor: pointer;
    }

    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--accent);
    }

    .checkbox-label {
      flex: 1;
    }

    .checkbox-title {
      font-weight: 600;
      font-size: 0.9375rem;
    }

    .checkbox-desc {
      color: var(--text-secondary);
      font-size: 0.8125rem;
    }

    .modal-footer {
      padding: 16px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    /* Responsive */
    @media (max-width: 1280px) {
      .sidebar-right {
        width: 290px;
      }
    }

    @media (max-width: 1024px) {
      .sidebar-right {
        display: none;
      }
      .main-content {
        max-width: 100%;
      }
    }

    @media (max-width: 768px) {
      .sidebar-left {
        width: 68px;
        padding: 0 4px;
      }
      .nav-item span:last-child,
      .user-info,
      .user-menu-dots {
        display: none;
      }
      .logo a {
        padding: 8px;
      }
      .nav-item {
        justify-content: center;
        padding: 12px;
      }
      .action-btn {
        width: 50px;
        height: 50px;
        padding: 0;
        font-size: 0;
      }
      .action-btn::before {
        content: '‚ö°';
        font-size: 1.5rem;
      }
      .user-menu {
        justify-content: center;
      }
    }

    /* Empty state */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .empty-icon {
      font-size: 3rem;
      margin-bottom: 16px;
    }

    .empty-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .site-footer {
      border-top: 1px solid var(--border);
      padding: 48px 24px;
      background: var(--bg-primary);
    }
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap: 32px;
    }
    .footer-section h4 { font-size: 0.875rem; font-weight: 700; margin-bottom: 12px; color: var(--text-primary); }
    .footer-section p { color: var(--text-secondary); font-size: 0.875rem; line-height: 1.5; margin-bottom: 8px; }
    .footer-section a { display: block; color: var(--text-secondary); text-decoration: none; font-size: 0.875rem; padding: 4px 0; transition: color 0.2s; }
    .footer-section a:hover { color: var(--accent); }
    .footer-bottom { max-width: 1200px; margin: 24px auto 0; padding-top: 24px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px; }
    .footer-bottom p { color: var(--text-secondary); font-size: 0.8125rem; }
    .footer-bottom a { color: var(--text-secondary); text-decoration: none; }
    .footer-bottom a:hover { color: var(--accent); }
    @media (max-width: 768px) { .footer-content { grid-template-columns: 1fr 1fr; } }
    @media (max-width: 480px) { .footer-content { grid-template-columns: 1fr; } }
    /* Skip Navigation */
    .skip-nav {
      position: absolute;
      top: -100%;
      left: 16px;
      background: var(--accent);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 700;
      z-index: 9999;
      text-decoration: none;
    }
    .skip-nav:focus {
      top: 16px;
    }

    /* Visible focus styles */
    :focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
  </style>
  <script src="/js/config.js" defer></script>
</head>
<body>
  <a href="#main-content" class="skip-nav">Skip to main content</a>
  <div class="layout">
    <!-- Left Sidebar -->
    <aside class="sidebar-left" aria-label="Main navigation">
      <div class="logo">
        <a href="/" aria-label="XActions Home">
          <span class="logo-icon">‚ö°</span>
        </a>
      </div>

      <nav>
        <a href="/" class="nav-item active" aria-label="Home">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></span>
          <span>Home</span>
        </a>
        <a href="/run" class="nav-item" aria-label="Run Scripts">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></span>
          <span>Run</span>
        </a>
        <a href="/dashboard" class="nav-item" aria-label="Dashboard">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg></span>
          <span>Dashboard</span>
        </a>
        <a href="/features" class="nav-item" aria-label="Scripts">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg></span>
          <span>Scripts</span>
        </a>
        <a href="/video" class="nav-item" aria-label="Video Downloader">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg></span>
          <span>Video</span>
        </a>
        <a href="/thread" class="nav-item" aria-label="Thread Reader">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></span>
          <span>Thread Reader</span>
        </a>
        <a href="/mcp" class="nav-item" aria-label="AI / MCP">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="20" y1="14" x2="23" y2="14"/><line x1="1" y1="9" x2="4" y2="9"/><line x1="1" y1="14" x2="4" y2="14"/></svg></span>
          <span>AI / MCP</span>
        </a>
        <a href="/price-correlation" class="nav-item" aria-label="Tweet-Price Charts">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg></span>
          <span>Price Charts</span>
        </a>
        <a href="/analytics-dashboard" class="nav-item" aria-label="Analytics Dashboard">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg></span>
          <span>Analytics</span>
        </a>
        <a href="/calendar" class="nav-item" aria-label="Content Calendar">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></span>
          <span>Calendar</span>
        </a>
        <a href="/thread-composer" class="nav-item" aria-label="Thread Composer">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></span>
          <span>Threads</span>
        </a>
        <a href="/team" class="nav-item" aria-label="Team Management">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></span>
          <span>Team</span>
        </a>
        <a href="/docs" class="nav-item" aria-label="Documentation">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg></span>
          <span>Docs</span>
        </a>
        <a href="/tutorials" class="nav-item" aria-label="Tutorials">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></span>
          <span>Tutorials</span>
        </a>
        <a href="/about" class="nav-item" aria-label="About">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></span>
          <span>About</span>
        </a>
        <a href="https://github.com/nirholas/XActions" class="nav-item" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg></span>
          <span>GitHub</span>
        </a>
      </nav>

      <a href="/run" class="action-btn">Run Script</a>

      <a href="/login" class="user-menu" id="user-menu-link">
        <div class="user-avatar" id="user-avatar">?</div>
        <div class="user-info">
          <div class="user-name" id="user-display-name">Login / Sign Up</div>
          <div class="user-handle" id="user-handle">Click to continue</div>
        </div>
        <span class="user-menu-dots">¬∑¬∑¬∑</span>
      </a>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
      <header class="main-header">
        <div class="header-title">
          <h1>Home</h1>
          <p id="header-subtitle">XActions Automation</p>
        </div>
        <div class="tabs">
          <div class="tab active" data-tab="operations">Operations</div>
          <div class="tab" data-tab="activity">Activity</div>
        </div>
      </header>

      <!-- Free & Open Source Banner -->
      <div class="free-banner" style="background: linear-gradient(90deg, #00ba7c, #1d9bf0); padding: 12px 20px; border-radius: 12px; margin: 16px; text-align: center;">
        <span style="font-weight: 700;">üéâ XActions is 100% Free & Open Source</span>
        <span style="margin-left: 12px; opacity: 0.9;">No accounts, no payments, no limits</span>
        <a href="https://github.com/nirholas/XActions" style="margin-left: 12px; color: white; text-decoration: underline;">Star on GitHub ‚≠ê</a>
      </div>

      <!-- Legal Disclaimer Banner -->
      <div class="legal-banner">
        <strong>‚ö†Ô∏è Educational Use Only:</strong> XActions demonstrates browser automation techniques for educational purposes. 
        Users are responsible for compliance with X/Twitter's Terms of Service. This tool is not affiliated with, endorsed by, or connected to X Corp.
        <a href="/docs#disclaimer" style="color: var(--accent);">Learn more ‚Üí</a>
      </div>

      <!-- Operations Section -->
      <section class="operations-section" id="operations">
        <div class="section-header">
          <h2 class="section-title">Operations</h2>
        </div>

        <!-- Browser Connection Status -->
        <div id="browser-connection" style="background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span id="connection-indicator" role="status" aria-label="Connection status: not connected" style="width: 12px; height: 12px; border-radius: 50%; background: var(--text-secondary);"></span>
              <div>
                <div id="connection-status-text" style="font-weight: 600;">Not Connected</div>
                <div id="connection-substatus" style="color: var(--text-secondary); font-size: 0.8125rem;">Connect your x.com browser tab to run operations</div>
              </div>
            </div>
            <button id="connect-browser-btn" onclick="connectBrowser()" class="btn-primary" style="padding: 10px 20px; border-radius: 9999px; font-size: 0.875rem;">
              Connect Browser
            </button>
          </div>
        </div>

        <!-- Live Progress Panel (hidden by default) -->
        <div id="live-progress" style="display: none; background: linear-gradient(135deg, rgba(0, 186, 124, 0.1), var(--bg-secondary)); border: 2px solid var(--success); border-radius: 16px; padding: 20px; margin-bottom: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 1.5rem;">üöÄ</span>
              <div>
                <div id="operation-name" style="font-weight: 700; font-size: 1.125rem;">Running Operation...</div>
                <div id="operation-status" style="color: var(--text-secondary); font-size: 0.875rem;"></div>
              </div>
            </div>
            <button onclick="stopOperation()" style="background: var(--error); color: white; border: none; padding: 8px 16px; border-radius: 9999px; cursor: pointer; font-weight: 600;">Stop</button>
          </div>
          <div style="background: var(--bg-primary); border-radius: 8px; height: 12px; overflow: hidden; margin-bottom: 12px;">
            <div id="progress-bar" style="height: 100%; background: linear-gradient(90deg, var(--accent), var(--success)); width: 0%; transition: width 0.3s;"></div>
          </div>
          <div style="display: flex; justify-content: space-between; font-size: 0.875rem; color: var(--text-secondary);">
            <span id="progress-message">Starting...</span>
            <span id="progress-count">0/0</span>
          </div>
          
          <!-- Live Log -->
          <div id="live-log" aria-live="polite" aria-label="Operation log" style="margin-top: 16px; background: var(--bg-primary); border-radius: 8px; padding: 12px; max-height: 150px; overflow-y: auto; font-family: monospace; font-size: 0.75rem;">
          </div>
        </div>

        <div class="operation-card" role="button" tabindex="0" onclick="openOperationModal('unfollowNonFollowers')" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();openOperationModal('unfollowNonFollowers')}">
          <div class="operation-header">
            <span class="operation-icon" aria-hidden="true">üßπ</span>
            <div class="operation-info">
              <div class="operation-title">Unfollow Non-Followers</div>
              <div class="operation-desc">Remove accounts that don't follow you back. Clean up your following list.</div>
            </div>
            <span class="operation-cost" style="background: var(--success);">Free</span>
          </div>
        </div>

        <div class="operation-card" role="button" tabindex="0" onclick="openOperationModal('unfollowEveryone')" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();openOperationModal('unfollowEveryone')}">
          <div class="operation-header">
            <span class="operation-icon" aria-hidden="true">üí•</span>
            <div class="operation-info">
              <div class="operation-title">Unfollow Everyone</div>
              <div class="operation-desc">Start fresh ‚Äî unfollow your entire following list at once.</div>
            </div>
            <span class="operation-cost" style="background: var(--success);">Free</span>
          </div>
        </div>

        <div class="operation-card" role="button" tabindex="0" onclick="openOperationModal('detectUnfollowers')" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();openOperationModal('detectUnfollowers')}">
          <div class="operation-header">
            <span class="operation-icon" aria-hidden="true">üîç</span>
            <div class="operation-info">
              <div class="operation-title">Detect Unfollowers</div>
              <div class="operation-desc">Find out who stopped following you recently.</div>
            </div>
            <span class="operation-cost" style="background: var(--success);">Free</span>
          </div>
        </div>
      </section>

      <!-- Recent Activity -->
      <section class="activity-section">
        <div class="section-header" style="padding: 16px;">
          <h2 class="section-title">Recent Activity</h2>
        </div>
        <div id="recent-operations-list" aria-live="polite" aria-atomic="false">
          <div class="empty-state">
            <div class="empty-icon">üìã</div>
            <div class="empty-title">No operations yet</div>
            <p>Run your first operation to see activity here</p>
          </div>
        </div>
      </section>
    </main>

    <!-- Right Sidebar -->
    <aside class="sidebar-right" aria-label="Supplementary information">
      <div class="search-box">
        <div class="search-input-wrapper">
          <span class="search-icon"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="var(--text-secondary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span>
          <input type="text" class="search-input" placeholder="Search XActions" aria-label="Search XActions">
        </div>
      </div>

      <!-- Account Stats -->
      <div class="stats-card">
        <h3 class="stats-header">Your Activity</h3>
        <div class="stat-row">
          <span class="stat-label">Plan</span>
          <span class="stat-value" style="color: var(--success);">100% Free</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Operations Run</span>
          <span class="stat-value" id="total-operations">0</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Total Unfollowed</span>
          <span class="stat-value" id="total-unfollowed">0</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Status</span>
          <span class="stat-value">Open Source</span>
        </div>
        <a href="https://github.com/nirholas/XActions" class="show-more" target="_blank" rel="noopener noreferrer">View on GitHub ‚Üí</a>
      </div>

      <!-- What's New -->
      <div class="tips-card">
        <h3 class="tips-header">What's happening</h3>
        <div class="tip-item">
          <div class="tip-title">‚ö° 43+ Free Automation Scripts</div>
          <div class="tip-desc">Mass unfollow, scrapers, auto-engage, video download & more</div>
        </div>
        <div class="tip-item">
          <div class="tip-title">ü§ñ AI / MCP Server</div>
          <div class="tip-desc">Connect Claude, GPT, or any AI agent to automate X</div>
        </div>
        <div class="tip-item">
          <div class="tip-title">üîì 100% Open Source</div>
          <div class="tip-desc">No API keys needed ‚Äî runs in your browser console</div>
        </div>
        <a href="/features" class="show-more">Show more</a>
      </div>

      <!-- Disclaimer Footer -->
      <div class="disclaimer">
        <div class="disclaimer-links">
          <a href="/docs#terms">Terms</a>
          <a href="/docs#privacy">Privacy</a>
          <a href="/docs#disclaimer">Disclaimer</a>
          <a href="https://github.com/nirholas/XActions">Open Source</a>
        </div>
        <p>
          XActions is an independent project for educational purposes. 
          Not affiliated with X Corp. Use responsibly and in accordance with X's Terms of Service.
        </p>
        <p style="margin-top: 8px;">¬© 2026 XActions ¬∑ <a href="https://x.com/nichxbt" target="_blank" rel="noopener noreferrer">@nichxbt</a></p>
      </div>
    </aside>
  </div>

  <!-- Operation Modal -->
  <div class="modal-overlay" id="operation-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal">
      <div class="modal-header">
        <button class="modal-close" onclick="closeModal()" aria-label="Close dialog">‚úï</button>
        <h2 class="modal-title" id="modal-title">Configure Operation</h2>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label" for="max-unfollows">Maximum Unfollows</label>
          <input type="number" class="form-input" id="max-unfollows" value="100" min="1" max="1000">
          <p style="color: var(--text-secondary); font-size: 0.8125rem; margin-top: 8px;">
            Set a limit to control how many accounts to unfollow in this operation.
          </p>
        </div>
        
        <div class="form-group">
          <label class="checkbox-group">
            <input type="checkbox" id="dry-run">
            <div class="checkbox-label">
              <div class="checkbox-title">Dry Run Mode</div>
              <div class="checkbox-desc">Preview the results without making any changes</div>
            </div>
          </label>
        </div>

        <div class="legal-banner" style="margin: 0;">
          <strong>Reminder:</strong> This operation will interact with your X account. 
          Make sure you understand what this operation does before proceeding.
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn-primary" style="width: auto; padding: 12px 32px;" onclick="startOperation()">Start Operation</button>
      </div>
    </div>
  </div>

  <script>
    const API_URL = window.location.hostname === 'localhost' 
      ? 'http://localhost:3001/api' 
      : '/api';
    const WS_URL = window.location.hostname === 'localhost'
      ? 'http://localhost:3001'
      : window.location.origin;
    let currentOperation = null;
    let authToken = localStorage.getItem('authToken');
    let socket = null;
    let sessionId = null;
    let agentConnected = false;

    // ===== SOCKET.IO REAL-TIME CONNECTION =====
    function initSocket() {
      if (!authToken) {
        showToast('Please log in first to connect your browser.', 'error');
        window.location.href = '/login';
        return;
      }

      socket = io(WS_URL, {
        auth: { token: authToken, role: 'dashboard' },
        reconnection: true,
        reconnectionAttempts: 5,
        reconnectionDelay: 1000
      });

      socket.on('connect', () => {
        console.log('‚úÖ Dashboard connected to server');
        document.getElementById('connection-substatus').textContent = 'Socket connected, waiting for session...';
      });

      socket.on('connect_error', (error) => {
        console.error('‚ùå Socket connection error:', error.message);
        if (error.message.includes('Invalid token') || error.message.includes('Authentication')) {
          showToast('Session expired. Please log in again.', 'error');
          localStorage.removeItem('authToken');
          window.location.href = '/login';
        } else {
          document.getElementById('connection-substatus').textContent = 'Connection failed: ' + error.message;
        }
      });

      socket.on('session:created', (data) => {
        sessionId = data.sessionId;
        console.log('üì° Session created:', sessionId);
        // Store agent script for display
        window.agentScript = data.agentScript;
        document.getElementById('connection-substatus').textContent = 'Session ready! Click Connect Browser to continue.';
      });

      socket.on('agent:connected', () => {
        agentConnected = true;
        updateConnectionStatus('connected');
        console.log('üîó Agent connected!');
      });

      socket.on('agent:disconnected', () => {
        agentConnected = false;
        updateConnectionStatus('disconnected');
        console.log('‚ùå Agent disconnected');
      });

      socket.on('operation:started', (data) => {
        showProgress(data.operation);
      });

      socket.on('progress', (data) => {
        updateProgress(data);
      });

      socket.on('action', (data) => {
        addLogEntry(data);
      });

      socket.on('complete', (data) => {
        completeOperation(data);
      });

      socket.on('error', (data) => {
        handleError(data);
      });
    }

    function updateConnectionStatus(status) {
      const indicator = document.getElementById('connection-indicator');
      const statusText = document.getElementById('connection-status-text');
      const substatus = document.getElementById('connection-substatus');
      const btn = document.getElementById('connect-browser-btn');

      if (status === 'connected') {
        indicator.style.background = 'var(--success)';
        indicator.style.boxShadow = '0 0 8px var(--success)';
        statusText.textContent = 'üü¢ Browser Connected';
        substatus.textContent = 'Ready to run operations on x.com';
        btn.textContent = 'Connected ‚úì';
        btn.disabled = true;
        btn.style.background = 'var(--success)';
      } else if (status === 'waiting') {
        indicator.style.background = 'var(--warning)';
        indicator.style.boxShadow = '0 0 8px var(--warning)';
        statusText.textContent = 'üü° Waiting for Browser';
        substatus.textContent = 'Paste the script in your x.com console';
        btn.textContent = 'Show Script';
      } else {
        indicator.style.background = 'var(--text-secondary)';
        indicator.style.boxShadow = 'none';
        statusText.textContent = 'Not Connected';
        substatus.textContent = 'Connect your x.com browser tab to run operations';
        btn.textContent = 'Connect Browser';
        btn.disabled = false;
        btn.style.background = 'var(--accent)';
      }
    }

    function connectBrowser() {
      if (!socket) initSocket();
      
      // Wait for session to be created
      setTimeout(() => {
        if (window.agentScript) {
          updateConnectionStatus('waiting');
          showAgentScriptModal();
        } else {
          showToast('Connecting... please wait and try again.', 'info');
        }
      }, 500);
    }

    function showAgentScriptModal() {
      const modal = document.createElement('div');
      modal.id = 'agent-script-modal';
      modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:9999;display:flex;align-items:center;justify-content:center;padding:24px;';
      modal.innerHTML = `
        <div style="background:var(--bg-secondary);border-radius:16px;max-width:600px;width:100%;max-height:90vh;overflow:auto;padding:24px;">
          <h2 style="margin-bottom:16px;display:flex;align-items:center;gap:12px;">
            <span>üîó</span> Connect Your Browser
          </h2>
          <ol style="color:var(--text-secondary);margin-bottom:20px;padding-left:20px;">
            <li style="margin-bottom:8px;">Open <a href="https://x.com" target="_blank" rel="noopener noreferrer" style="color:var(--accent);">x.com</a> in a new tab and log in</li>
            <li style="margin-bottom:8px;">Press <kbd style="background:var(--bg-tertiary);padding:2px 8px;border-radius:4px;">F12</kbd> to open Developer Tools</li>
            <li style="margin-bottom:8px;">Go to the <strong>Console</strong> tab</li>
            <li style="margin-bottom:8px;">Paste the script below and press Enter</li>
          </ol>
          <div style="position:relative;">
            <pre style="background:var(--bg-primary);padding:16px;border-radius:8px;overflow-x:auto;font-size:0.75rem;max-height:200px;overflow-y:auto;"><code id="agent-script-code">${window.agentScript}</code></pre>
            <button onclick="copyAgentScript()" style="position:absolute;top:8px;right:8px;background:var(--accent);color:white;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-weight:600;">Copy</button>
          </div>
          <div style="margin-top:20px;display:flex;gap:12px;">
            <button onclick="document.getElementById('agent-script-modal').remove()" style="flex:1;padding:12px;background:var(--bg-tertiary);color:var(--text-primary);border:none;border-radius:9999px;cursor:pointer;font-weight:600;">Close</button>
          </div>
          <p style="margin-top:16px;text-align:center;color:var(--text-secondary);font-size:0.8125rem;">The page will update automatically when connected</p>
        </div>
      `;
      document.body.appendChild(modal);
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.remove();
      });
    }

    function copyAgentScript() {
      navigator.clipboard.writeText(window.agentScript);
      const btn = event.target;
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy', 2000);
    }

    function showProgress(operation) {
      document.getElementById('live-progress').style.display = 'block';
      document.getElementById('operation-name').textContent = formatOperationName(operation);
      document.getElementById('progress-bar').style.width = '0%';
      document.getElementById('progress-message').textContent = 'Starting...';
      document.getElementById('progress-count').textContent = '0/0';
      document.getElementById('live-log').innerHTML = '';
    }

    function updateProgress(data) {
      document.getElementById('progress-bar').style.width = (data.percent || 0) + '%';
      document.getElementById('progress-message').textContent = data.message || '';
      document.getElementById('progress-count').textContent = `${data.current || 0}/${data.max || '?'}`;
      document.getElementById('operation-status').textContent = data.status || '';
    }

    function addLogEntry(data) {
      const log = document.getElementById('live-log');
      const entry = document.createElement('div');
      entry.style.cssText = 'padding:4px 0;border-bottom:1px solid var(--border);display:flex;gap:8px;';
      entry.innerHTML = `
        <span style="color:var(--text-secondary);">${new Date().toLocaleTimeString()}</span>
        <span style="color:var(--success);">${data.type}</span>
        ${data.handle ? `<span style="color:var(--accent);">@${data.handle}</span>` : ''}
      `;
      log.insertBefore(entry, log.firstChild);
    }

    function completeOperation(data) {
      document.getElementById('progress-bar').style.width = '100%';
      document.getElementById('progress-message').textContent = '‚úÖ Complete!';
      document.getElementById('operation-status').textContent = data.stopped ? 'Stopped by user' : 'Finished successfully';
      
      // Show summary
      setTimeout(() => {
        showToast('Operation complete!', 'success');
      }, 500);
    }

    function handleError(data) {
      document.getElementById('progress-message').textContent = '‚ùå ' + data.message;
      document.getElementById('progress-bar').style.background = 'var(--error)';
      
      if (data.agentDisconnected) {
        showToast('Browser disconnected. Please reconnect and try again.', 'error');
        updateConnectionStatus('disconnected');
      }
    }

    function stopOperation() {
      if (socket) {
        socket.emit('stop:operation');
      }
    }

    function formatOperationName(op) {
      const names = {
        unfollowNonFollowers: 'üßπ Unfollow Non-Followers',
        unfollowEveryone: 'üí• Unfollow Everyone',
        detectUnfollowers: 'üîç Detect Unfollowers'
      };
      return names[op] || op;
    }

    // WebSocket-based operation trigger (used when agent is connected)
    function runOperationViaSocket(operation, config) {
      if (!agentConnected) {
        showToast('Please connect your browser first! Click "Connect Browser" above.', 'warning');
        return;
      }
      socket.emit('start:operation', { operation, config });
    }

    // Initialize socket on page load
    if (authToken) {
      initSocket();
    }

    // Load dashboard data
    async function loadDashboard() {
      if (!authToken) {
        window.location.href = '/login';
        return;
      }

      try {
        // Load profile
        const profileRes = await fetch(`${API_URL}/user/profile`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        
        if (!profileRes.ok) {
          if (profileRes.status === 401) {
            console.error('Unauthorized - logging out');
            logout();
            return;
          }
          throw new Error(`Profile fetch failed: ${profileRes.status}`);
        }
        
        const profile = await profileRes.json();

        // Update user menu - show logged in state
        const initial = (profile.email || profile.username || '?')[0].toUpperCase();
        document.getElementById('user-avatar').textContent = initial;
        document.getElementById('user-display-name').textContent = profile.username || profile.email?.split('@')[0] || 'User';
        document.getElementById('user-handle').textContent = profile.twitterUsername ? `@${profile.twitterUsername}` : '@' + (profile.username || 'user');
        document.getElementById('user-menu-link').href = '#';
        document.getElementById('user-menu-link').onclick = toggleUserMenu;
        document.querySelector('.user-menu-dots').textContent = '¬∑¬∑¬∑';

        // Check auth method
        const authRes = await fetch(`${API_URL}/session/auth-method`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        const authData = await authRes.json();

        // Update Twitter status
        if (authData.hasOAuth || authData.hasSession) {
          const method = authData.hasOAuth ? 'OAuth' : 'Session Cookie';
          const statusSection = document.getElementById('twitter-status');
          statusSection.classList.add('connected');
          statusSection.innerHTML = `
            <div class="connect-inner" style="background: linear-gradient(135deg, rgba(0, 186, 124, 0.1) 0%, rgba(29, 155, 240, 0.1) 100%);">
              <div class="connect-header">
                <span class="connect-icon">‚úÖ</span>
                <h2 class="connect-title">X Account Connected</h2>
              </div>
              <p class="connect-desc">@${authData.username || 'Your account'} connected via ${method}</p>
              <button class="btn-secondary" onclick="disconnectTwitter()">Disconnect Account</button>
            </div>
          `;
          document.getElementById('header-subtitle').textContent = `Connected as @${authData.username || 'user'}`;
        }

        // Load stats
        const statsRes = await fetch(`${API_URL}/user/stats`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        const stats = await statsRes.json();

        document.getElementById('total-operations').textContent = stats.totalOperations;
        document.getElementById('total-unfollowed').textContent = stats.totalUnfollows;

        // Load recent operations
        loadRecentOperations();
      } catch (error) {
        console.error('Failed to load dashboard:', error);
        // Clear the loading state on error
        document.getElementById('user-display-name').textContent = 'Error';
        document.getElementById('user-handle').textContent = 'Failed to load';
      }
    }

    async function loadRecentOperations() {
      try {
        const res = await fetch(`${API_URL}/operations?limit=5`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        const data = await res.json();

        if (!data.operations || data.operations.length === 0) return;

        const html = data.operations.map(op => `
          <div class="activity-item">
            <div class="activity-icon">${getOperationIcon(op.type)}</div>
            <div class="activity-content">
              <div class="activity-text"><strong>${formatOperationType(op.type)}</strong></div>
              <div class="activity-time">${new Date(op.createdAt).toLocaleString()}</div>
            </div>
            <span class="activity-status status-${op.status}">${op.status}</span>
          </div>
        `).join('');

        document.getElementById('recent-operations-list').innerHTML = html;
      } catch (e) {
        console.error('Failed to load operations:', e);
      }
    }

    function getOperationIcon(type) {
      const icons = {
        unfollowNonFollowers: 'üßπ',
        unfollowEveryone: 'üí•',
        detectUnfollowers: 'üîç'
      };
      return icons[type] || '‚öôÔ∏è';
    }

    function formatOperationType(type) {
      const types = {
        unfollowNonFollowers: 'Unfollow Non-Followers',
        unfollowEveryone: 'Unfollow Everyone',
        detectUnfollowers: 'Detect Unfollowers'
      };
      return types[type] || type;
    }

    function showAuthMethod(method) {
      document.querySelectorAll('.auth-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.auth-tab').forEach(el => el.classList.remove('active'));
      
      document.getElementById(`${method}-method`).classList.add('active');
      document.getElementById(`${method}-tab`).classList.add('active');
    }

    async function connectTwitterOAuth() {
      try {
        const res = await fetch(`${API_URL}/twitter/connect`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        const data = await res.json();
        window.location.href = data.authUrl;
      } catch (e) {
        showToast('Failed to connect. Please try again.', 'error');
      }
    }

    async function saveSessionCookie() {
      const sessionCookie = document.getElementById('session-cookie-input').value.trim();
      const username = document.getElementById('twitter-username-input').value.trim();

      if (!sessionCookie) {
        showToast('Please paste your session cookie', 'warning');
        return;
      }

      try {
        const res = await fetch(`${API_URL}/session/save-session`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${authToken}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ sessionCookie, username })
        });

        const data = await res.json();

        if (res.ok) {
          showToast('Session saved successfully!', 'success');
          location.reload();
        } else {
          alert(`‚ùå Error: ${data.error}`);
        }
      } catch (error) {
        showToast('Failed to save session cookie', 'error');
      }
    }

    async function disconnectTwitter() {
      if (!confirm('Are you sure you want to disconnect your X account?')) return;
      
      try {
        await fetch(`${API_URL}/twitter/disconnect`, {
          method: 'POST',
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        await fetch(`${API_URL}/session/remove-session`, {
          method: 'DELETE',
          headers: { 'Authorization': `Bearer ${authToken}` }
        });
        location.reload();
      } catch (e) {
        showToast('Failed to disconnect', 'error');
      }
    }

    function openOperationModal(type) {
      currentOperation = type;
      document.getElementById('modal-title').textContent = `Configure ${formatOperationType(type)}`;
      document.getElementById('operation-modal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      document.getElementById('operation-modal').classList.remove('active');
      document.body.style.overflow = '';
    }

    async function startOperation() {
      const maxUnfollows = document.getElementById('max-unfollows').value;
      const dryRun = document.getElementById('dry-run').checked;

      try {
        const res = await fetch(`${API_URL}/operations/${currentOperation.replace(/([A-Z])/g, '-$1').toLowerCase()}`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${authToken}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ maxUnfollows: parseInt(maxUnfollows), dryRun })
        });

        const data = await res.json();
        
        if (res.ok) {
          showToast('Operation started successfully!', 'success');
          closeModal();
          loadDashboard();
        } else {
          alert(`‚ùå Error: ${data.error}`);
        }
      } catch (error) {
        showToast('Failed to start operation', 'error');
      }
    }

    function scrollToSection(id) {
      document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
    }

    function toggleUserMenu() {
      if (confirm('Do you want to log out?')) {
        logout();
      }
    }

    function logout() {
      localStorage.removeItem('authToken');
      window.location.href = '/login';
    }

    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // Close modal on overlay click
    document.getElementById('operation-modal').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) closeModal();
    });

    // Search box ‚Äî navigate to relevant pages
    const searchInput = document.querySelector('.search-input');
    if (searchInput) {
      const searchRoutes = [
        { keywords: ['unfollow', 'cleanup', 'non-follower', 'mass unfollow'], href: '/features', label: 'Unfollow Scripts' },
        { keywords: ['video', 'download', 'media', 'save'], href: '/video', label: 'Video Downloader' },
        { keywords: ['thread', 'unroll', 'read'], href: '/thread', label: 'Thread Reader' },
        { keywords: ['ai', 'writer', 'generate', 'gpt', 'claude', 'llm'], href: '/ai', label: 'AI Tools' },
        { keywords: ['mcp', 'agent', 'model context'], href: '/mcp', label: 'MCP Server' },
        { keywords: ['automate', 'automation', 'bot', 'auto like', 'auto follow'], href: '/automations', label: 'Automations' },
        { keywords: ['workflow', 'builder', 'chain'], href: '/workflows', label: 'Workflow Builder' },
        { keywords: ['monitor', 'track', 'alert', 'watch'], href: '/monitor', label: 'Monitor' },
        { keywords: ['analytics', 'sentiment', 'stats', 'report'], href: '/analytics', label: 'Analytics' },
        { keywords: ['bookmark', 'save', 'export'], href: '/bookmarks', label: 'Bookmarks' },
        { keywords: ['post', 'tweet', 'compose', 'schedule', 'thread'], href: '/posting', label: 'Post Composer' },
        { keywords: ['engage', 'like', 'reply', 'retweet'], href: '/engagement', label: 'Engagement' },
        { keywords: ['profile', 'bio', 'edit', 'avatar'], href: '/profile', label: 'Profile' },
        { keywords: ['script', 'run', 'bookmarklet', 'code'], href: '/run', label: 'Run Scripts' },
        { keywords: ['doc', 'help', 'guide', 'how to', 'setup'], href: '/docs', label: 'Documentation' },
        { keywords: ['tutorial', 'learn', 'beginner'], href: '/tutorials', label: 'Tutorials' },
        { keywords: ['price', 'plan', 'cost', 'free'], href: '/pricing', label: 'Pricing' },
        { keywords: ['unfollower', 'who unfollowed', 'lost follower'], href: '/unfollowers', label: 'Unfollower Tracker' },
      ];

      searchInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          const query = searchInput.value.trim().toLowerCase();
          if (!query) return;
          const match = searchRoutes.find(r => r.keywords.some(k => query.includes(k) || k.includes(query)));
          if (match) {
            window.location.href = match.href;
          } else {
            window.location.href = `/features`;
          }
        }
      });
    }

    // Load on page load
    loadDashboard();
    setInterval(loadRecentOperations, 10000);

    // Socket already initialized above ‚Äî no duplicate call
  </script>

  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>XActions</h4>
        <p>100% Free & Open Source X/Twitter Automation</p>
        <p>Created by <a href="https://x.com/nichxbt" rel="noopener">@nichxbt</a></p>
      </div>
      <div class="footer-section">
        <h4>Product</h4>
        <a href="/features">Features</a>
        <a href="/video">Video Downloader</a>
        <a href="/pricing">Pricing</a>
        <a href="/run">Run Scripts</a>
        <a href="/dashboard">Dashboard</a>
        <a href="/automations">Automations</a>
        <a href="/workflows">Workflows</a>
        <a href="/analytics">Analytics</a>
        <a href="/monitor">Monitor</a>
      </div>
      <div class="footer-section">
        <h4>AI & Developers</h4>
        <a href="/ai">AI Integration</a>
        <a href="/ai-api">AI API</a>
        <a href="/mcp">MCP Server</a>
        <a href="/docs">Documentation</a>
        <a href="/tutorials">Tutorials</a>
      </div>
      <div class="footer-section">
        <h4>Community</h4>
        <a href="https://github.com/nirholas/XActions" rel="noopener">GitHub</a>
        <a href="https://github.com/nirholas/XActions/issues" rel="noopener">Report Issues</a>
        <a href="https://github.com/nirholas/XActions/blob/main/CONTRIBUTING.md" rel="noopener">Contribute</a>
        <a href="/about">About</a>
        <a href="/terms">Terms</a>
        <a href="/privacy">Privacy</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© 2024-2026 XActions. MIT License. No API fees. No limits.</p>
    </div>
  </footer>
</body>
</html>

